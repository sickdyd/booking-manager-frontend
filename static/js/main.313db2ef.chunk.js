(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{239:function(e,t,n){e.exports=n(443)},244:function(e,t,n){},443:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(7),c=n.n(l),o=(n(244),n(44)),i=n(71),u=(n(245),n(237)),s=n(27),m=n.n(s),d=n(39),f=n(203),p=n(204),b=n(205),h=n.n(b),g=n(66),E=n(206),v=n.n(E),y="http://localhost:3333/api";y="https://sickdyd-booking-manager.herokuapp.com/api",console.log("Sending requests to: ",y);var k=v.a.create({baseURL:y});k.defaults.headers.post["Content-Type"]="application/json",k.interceptors.request.use((function(e){return console.log(e),e}),(function(e){return console.log(e),Promise.reject(e)})),k.interceptors.response.use((function(e){var t=e.headers["x-auth-token"];return t&&(S.setAuthentication(t),localStorage.setItem("bmtoken",t)),console.log(e),e}),(function(e){return console.log(e),Promise.reject(e)}));var O=k,j=n(447),x=n(458),w=function(e){try{return function(e){if((null===e||void 0===e?void 0:e.status)>=200&&(null===e||void 0===e?void 0:e.status)<300)return e;401===(null===e||void 0===e?void 0:e.status)&&S.logout();var t=function(e){var t,n,a,r;return(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.error)||void 0===n?void 0:n.message)?null===e||void 0===e||null===(a=e.data)||void 0===a||null===(r=a.error)||void 0===r?void 0:r.message:null===e||void 0===e?void 0:e.message}(e);x.a.warn({message:"Error",description:t})}((null===e||void 0===e?void 0:e.response)?null===e||void 0===e?void 0:e.response:e),Promise.reject()}catch(t){return console.log(t),Promise.reject()}},C={login:function(e,t){return O.post("/authenticate/",{email:e,password:t})},getSchedule:function(e,t){return O.get("/schedule/")},book:function(e){return O.post("/bookings/",{unix:e,user:S.getId()}).then((function(e){return j.a.success("\u4e88\u7d04\u3092\u3057\u307e\u3057\u305f\u3002"),e})).catch((function(e){return w(e)}))},deleteBooking:function(e){return O.delete("/bookings/"+e).then((function(e){return j.a.success("\u4e88\u7d04\u304c\u524a\u9664\u3055\u308c\u307e\u3057\u305f\u3002"),e})).catch((function(e){return w(e)}))},getUserBookings:function(e){return O.get("/users/"+e+"/bookings").then((function(e){return e})).catch((function(e){return w(e)}))},getPoints:function(e){return O.get("/users/"+e+"/points").then((function(e){return e})).catch((function(e){return w(e)}))},getSettings:function(){return O.get("/settings/").then((function(e){return e})).catch((function(e){return w(e)}))},saveSettings:function(e){return O.put("/settings/",e).then((function(e){return j.a.success("Settings saved"),e})).catch((function(e){return w(e)}))},getDaySlots:function(){return O.get("/schedule/slots").then((function(e){return e})).catch((function(e){return w(e)}))},getBookings:function(){return O.get("/bookings").then((function(e){return e})).catch((function(e){return w(e)}))},getUsers:function(){return O.get("/users/").then((function(e){return e})).catch((function(e){return w(e)}))},updateUser:function(e,t){return O.patch("/users/"+t,e).then((function(e){return j.a.success("User data udpated"),e})).catch((function(e){return w(e)}))},deleteUser:function(e){return O.delete("/users/"+e).then((function(e){return j.a.success("User deleted"),e})).catch((function(e){return w(e)}))},createUser:function(e){return O.post("/users",e).then((function(e){return j.a.success("User created"),e})).catch((function(e){return w(e)}))},changePassword:function(e,t){return O.patch("/users/"+t,{password:e}).then((function(e){return j.a.success("Password changed"),e})).catch((function(e){return w(e)}))},close:function(e){return O.post("/bookings/close",{unix:e}).then((function(e){return j.a.success("Slot closed"),e})).catch((function(e){return w(e)}))},open:function(e){return O.delete("/bookings/"+e).then((function(e){return j.a.success("Slot opened"),e})).catch((function(e){return w(e)}))},bookForUser:function(e,t){return O.post("/bookings/",{unix:e,user:t}).then((function(e){return j.a.success("Slot assigned"),e})).catch((function(e){return w(e)}))},bookBatch:function(e){return O.post("/bookings/batch",Object(g.a)({},e)).then((function(e){return j.a.success("Slots assigned"),e})).catch((function(e){return w(e)}))},deleteUserBooking:function(e){return O.delete("/bookings/"+e).then((function(e){return j.a.success("Booking deleted"),e})).catch((function(e){return w(e)}))}},S=new(function(){function e(){Object(f.a)(this,e),this.authenticated=!1;var t=localStorage.getItem("bmtoken");t&&(this.setAuthentication(t),this.authenticated=!0)}return Object(p.a)(e,[{key:"login",value:function(){var e=Object(d.a)(m.a.mark((function e(t,n){var a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.login(t,n).then((function(e){a.setAuthentication(e.data),localStorage.setItem("bmtoken",e.data)})).catch((function(e){return w(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setAuthentication",value:function(e){var t=h()(e),n=t._id,a=t.admin;this.token=e,this.id=n,this.admin=a,O.defaults.headers.common["x-auth-token"]=e,this.authenticated=!0}},{key:"logout",value:function(e){this.authenticated=!1,localStorage.removeItem("bmtoken"),O.defaults.headers.common["x-auth-token"]=void 0,window.location.reload()}},{key:"isAuthenticated",value:function(){return this.authenticated}},{key:"isAdmin",value:function(){return this.admin}},{key:"getToken",value:function(){return this.token}},{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}}]),e}()),I=function(e){var t=e.component,n=e.admin,a=(e.children,Object(u.a)(e,["component","admin","children"]));return r.a.createElement(i.b,Object.assign({},a,{render:function(e){return!S.isAuthenticated()||!S.isAdmin()&&n?r.a.createElement(i.a,{to:{pathname:"/login",state:{from:e.location}}}):r.a.createElement(t,e)}}))},U=n(29),N=n(5),B=n(451),P=n(454),F=n(23),T=n(30);function A(){var e=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2em;\n    box-shadow: 10px 10px 62px -25px rgba(0,0,0,0.75);\n\n    h2 {\n      margin: 16px 0 32px 0;\n    }\n  }\n"]);return A=function(){return e},e}var D={labelCol:{span:8},wrapperCol:{span:16}},L={wrapperCol:{offset:8,span:16}},M=function(){var e=Object(i.g)(),t=Object(a.useState)(!1),n=Object(N.a)(t,2),l=n[0],c=n[1],o=function(){var t=Object(d.a)(m.a.mark((function t(n){var a,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.email,r=n.password,c(!0),S.login(a,r).then((function(){return e.push("/schedule")})).catch((function(){return c(!1)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(q,null,r.a.createElement("div",{className:"container defaultBox"},r.a.createElement("h2",null,"\u3088\u3046\u3053\u305d!"),r.a.createElement(B.a,Object.assign({},D,{name:"basic",initialValues:{remember:!0,email:"test@gmail.com",password:"testing123"},onFinish:o}),r.a.createElement(B.a.Item,{label:"\u30de\u30a4\u30eb",name:"email",rules:[{required:!0,message:"Please input your email."}]},r.a.createElement(P.a,null)),r.a.createElement(B.a.Item,{label:"\u30d1\u30b9\u30ef\u30fc\u30c9",name:"password",rules:[{required:!0,message:"Please input your password."}]},r.a.createElement(P.a.Password,null)),r.a.createElement(B.a.Item,L,r.a.createElement(F.a,{type:"primary",htmlType:"submit",loading:l},"\u30ed\u30b0\u30a4\u30f3")))))},q=T.a.div(A()),z=n(448),H=n(95),R=n(466);function V(){var e=Object(U.a)(["\n\n  .logo {\n    color: white;\n    font-size: 1.1rem;\n    font-weight: bold;\n  }\n\n  .header {\n    padding: 32px !important;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n"]);return V=function(){return e},e}var _=z.a.Header,W=function(){return r.a.createElement(K,null,r.a.createElement(_,{className:"header"},r.a.createElement("div",{className:"logo"},"Booking"),S.authenticated&&r.a.createElement(H.a,{title:"\u30ed\u30b0\u30a2\u30a6\u30c8"},r.a.createElement(F.a,{size:"small",onClick:function(){return S.logout()},shape:"circle",icon:r.a.createElement(R.a,null)}))))},K=T.a.div(V()),J=n(80),Y=n(464),$=n(463),G=n(462),Q=n(456),X=n(460),Z=n(459);function ee(){var e=Object(U.a)(["\n  @media (max-width: 575.28px) {\n\n  }\n"]);return ee=function(){return e},e}var te=function(){var e=Object(i.g)();Object(a.useEffect)((function(){c(window.location.pathname.replace("/",""))}));var t=Object(a.useState)("home"),n=Object(N.a)(t,2),l=n[0],c=n[1],o=[r.a.createElement(J.a.Item,{key:"users"},r.a.createElement(Y.a,null),r.a.createElement("span",{className:"label"},"Users")),r.a.createElement(J.a.Item,{key:"create-user"},r.a.createElement($.a,null),r.a.createElement("span",{className:"label"},"Create user")),r.a.createElement(J.a.Item,{key:"create-bookings"},r.a.createElement(G.a,null),r.a.createElement("span",{className:"label"},"Create bookings")),r.a.createElement(J.a.Item,{key:"settings"},r.a.createElement(Q.a,null),r.a.createElement("span",{className:"label"},"Settings"))];return r.a.createElement(ne,null,r.a.createElement(J.a,{mode:"horizontal",selectedKeys:l,onClick:function(t){c(t.key),e.push("/"+t.key)}},r.a.createElement(J.a.Item,{key:"schedule"},r.a.createElement(X.a,null),r.a.createElement("span",{className:"label"},"Schedule")),r.a.createElement(J.a.Item,{key:"change-password"},r.a.createElement(Z.a,null),r.a.createElement("span",{className:"label"},"Change password")),S.isAdmin()&&o.map((function(e){return e}))))},ne=T.a.div(ee()),ae=n(24),re=n.n(ae),le=function(e){return r.a.createElement(F.a,Object.assign({shape:"round",size:"small",style:{margin:"8px"}},e),e.children)},ce=n(238),oe=n(457),ie=n(461),ue=function(e){var t=e.icon,n=e.text;return r.a.createElement(ie.a,{status:t,text:n,style:{marginRight:"8px"}})},se=n(470),me=n(469),de=n(468),fe=n(453),pe=n(109),be=function(e){var t=e.setUser,n=Object(a.useState)([]),l=Object(N.a)(n,2),c=l[0],o=l[1];Object(a.useEffect)((function(){C.getUsers().then((function(e){return o(e.data)})).catch((function(e){return console.log(e)}))}),[]);var i=pe.a.Option;return r.a.createElement(pe.a,{showSearch:!0,style:{width:200},placeholder:"Select a user",optionFilterProp:"children",onChange:function(e){t(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},c.map((function(e){return r.a.createElement(i,{key:e.email,value:e._id},e.email)})))},he=function(e){var t=e.children,n=e.slotId,l=e.onOk,c=e.fetchSchedule,o=Object(a.useState)(!1),i=Object(N.a)(o,2),u=i[0],s=i[1],m=Object(a.useState)(!1),d=Object(N.a)(m,2),f=d[0],p=d[1],b=Object(a.useState)(null),h=Object(N.a)(b,2),g=h[0],E=h[1],v=function(){return s(!u)},y=r.a.Children.map(t,(function(e){return Object(a.cloneElement)(e,{onClick:v})})),k=function(){p(!0),l(n,g).then((function(){return c()})).finally((function(){p(!1),s(!1)}))};return r.a.createElement(r.a.Fragment,null,y,r.a.createElement(fe.a,{title:"Assign slot to user",visible:u,onOk:k,onCancel:v,footer:[r.a.createElement(F.a,{key:"back",onClick:v},"Cancel"),r.a.createElement(F.a,{key:"submit",type:"primary",loading:f,onClick:k,disabled:void 0===g},"Ok")]},r.a.createElement("p",null,"Select the user"),r.a.createElement(be,{setUser:E})))},ge=function(e){var t=e.status,n=e.bookedAt,l=e.user,c=e.unix,o=e.fetchSchedule,i=Object(a.useState)(!1),u=Object(N.a)(i,2),s=u[0],m=u[1],d=function(e){m(!0),e(c).finally((function(){o()}))},f=Object(a.forwardRef)((function(e,t){return r.a.createElement("div",{style:{display:"inline-block"},ref:t},r.a.createElement(F.a,Object.assign({shape:"circle",size:"small",style:{marginRight:"8px"}},e)))})),p={onConfirm:function(){return d(C.deleteUserBooking)},placement:"top",title:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Cancel booking?"),r.a.createElement("p",null,"If you proceed you will cancel this booking:"),r.a.createElement("p",null,re.a.unix(c).locale("en").format("LLLL")),r.a.createElement("p",null,null===l||void 0===l?void 0:l.name," ",null===l||void 0===l?void 0:l.surname)),okText:"Ok",cancelText:"Cancel"},b={onConfirm:function(){},placement:"top",title:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Booked by"),r.a.createElement("p",null,"Name: ",null===l||void 0===l?void 0:l.name," ",r.a.createElement("br",null),"Surname: ",null===l||void 0===l?void 0:l.surname," ",r.a.createElement("br",null),"Email: ",null===l||void 0===l?void 0:l.email," ",r.a.createElement("br",null),"at: ",re.a.unix(n).locale("en").format("LLLL")," ",r.a.createElement("br",null))),okText:"Ok",cancelText:"Cancel"};return function(){switch(t){case"available":case"availableUncancellable":return r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{onClick:function(){return d(C.close)},icon:r.a.createElement(se.a,null),disabled:s}),r.a.createElement(he,{slotId:c,onOk:C.bookForUser,fetchSchedule:o},r.a.createElement(f,{icon:r.a.createElement($.a,null)})));case"booked":case"bookedUncancellable":return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,p,r.a.createElement(f,{icon:r.a.createElement(me.a,null),disabled:s})),r.a.createElement(oe.a,b,r.a.createElement(f,{icon:r.a.createElement(Y.a,null),disabled:s})));case"unavailable":return null;case"closed":return r.a.createElement(f,{onClick:function(){return d(C.open)},icon:r.a.createElement(de.a,null),disabled:s});default:return null}}()},Ee=function(e){var t=e.unix,n=e.start,l=e.status,c=e.user,o=e.fetchSchedule,i=Object(a.useState)(!1),u=Object(N.a)(i,2),s=u[0],m=u[1],d=function(){},f=function(e){m(!0),e(t).finally((function(){o().finally((function(){return m(!1)}))}))},p={onConfirm:function(){return f(C.book)},disabled:!1,placement:"top",title:r.a.createElement("p",null,"\u4e88\u7d04\u3092\u3057\u305f\u3044\u3067\u3059\u304b\uff1f",r.a.createElement("br",null),r.a.createElement("br",null)," \u4e88\u7d04\u3092\u3057\u307e\u3057\u305f\u3089\u30ad\u30e3\u30f3\u30bb\u30eb\u304c\u3067\u304d\u307e\u305b\u3093\u3002"),okText:"\u306f\u3044",cancelText:"\u30ad\u30e3\u30f3\u30bb\u30eb"},b=function(e){if(S.isAdmin())switch(e){case"available":case"availableUncancellable":return{tagColor:"green",onClick:d,popconfirm:{disabled:!0},icon:"success",text:"Available"};case"booked":case"bookedUncancellable":return{tagColor:"red",onClick:d,popconfirm:{disabled:!0},icon:"processing",text:"".concat(null===c||void 0===c?void 0:c.surname)};case"unavailable":return{tagColor:"default",onClick:d,popconfirm:{disabled:!0},icon:"default",text:"unavailable"};default:return{tagColor:"geekblue",onClick:d,popconfirm:{disabled:!0},icon:"default",text:"Closed"}}else switch(e){case"available":return{tooltip:"\u4e88\u7d04\u3092\u3057\u307e\u3059",button:"default",onClick:function(){return f(C.book)},popconfirm:{disabled:!0},icon:"success",text:"\u30d5\u30ea\u30fc"};case"availableUncancellable":return{tooltip:"\u4e88\u7d04\u3092\u3057\u307e\u3059",button:"default",onClick:d,popconfirm:p,icon:"warning",text:"\u30d5\u30ea\u30fc"};case"booked":return{tooltip:"\u30ad\u30e3\u30f3\u305b\u30eb",button:"primary",onClick:function(){return f(C.deleteBooking)},popconfirm:{disabled:!0},icon:"processing",text:"\u4e88\u7d04"};case"bookedUncancellable":return{tooltip:"\u30ad\u30e3\u30f3\u305b\u30eb\u3067\u304d\u307e\u305b\u3093",button:"danger",onClick:d,popconfirm:{disabled:!0},icon:"processing",text:"\u4e88\u7d04"};case"unavailable":default:return{tooltip:"\u5229\u7528\u3067\u304d\u307e\u305b\u3093",button:"dashed",onClick:d,popconfirm:{disabled:!0},icon:"default",text:"\u7121\u52b9"}}}(l),h=function(){return S.isAdmin()?r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.a,{color:b.tagColor,style:{margin:"8px"}},n),r.a.createElement(ge,e)):r.a.createElement(oe.a,b.popconfirm,r.a.createElement(H.a,{placement:"left",title:b.tooltip},r.a.createElement(le,{type:b.button,onClick:b.onClick,loading:s},n)))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null),r.a.createElement(ue,{icon:b.icon,text:b.text}))},ve=n(450),ye=function(e){var t=e.schedule,n=e.fetchSchedule,a=function(e){return S.isAdmin()?e.filter((function(e){return null!==(null===e||void 0===e?void 0:e.user)})).length:e.filter((function(e){var t;return(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t._id)===S.getId()})).length},l=function(e){return e.filter((function(e){return"available"===e.status!==("availableUncancellable"===e.status)})).length},c={expandable:{expandedRowRender:function(e){return(t=e.slots).length>0?r.a.createElement("div",{className:"defaultBox",style:{display:"flex",justifyContent:"center"}},r.a.createElement("div",null,t.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(Ee,Object.assign({},e,{fetchSchedule:n})))})))):r.a.createElement("i",null,"No slots available.");var t}},columns:[{title:"Schedule",dataIndex:"day",key:"day"},{dataIndex:"slots",key:Math.random(),width:"5%",render:function(e){return r.a.createElement(ie.a,{title:"Reservations",count:a(e),style:{backgroundColor:"#108ee9"}})}},{dataIndex:"slots",key:Math.random(),width:"5%",render:function(e){return r.a.createElement(ie.a,{title:"Free slots",count:l(e),style:{backgroundColor:"#52c41a"}})}}],dataSource:t,size:"small",style:{width:"100%"},onChange:function(e){console.log(e),n(e.current,e.pageSize)}};return r.a.createElement(ve.a,c)},ke=n(225),Oe=function(){return r.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"40vh"}},r.a.createElement(ke.a,null))},je=function(e){var t=e.schedule,n=Object(a.useState)(!0),l=Object(N.a)(n,2),c=l[0],o=l[1],i=Object(a.useState)(),u=Object(N.a)(i,2),s=u[0],m=u[1];return Object(a.useEffect)((function(){C.getPoints(S.getId()).then((function(e){var t;return m(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.points)})).finally((function(){return o(!1)}))}),[t]),r.a.createElement("p",{style:{textAlign:"center",marginBottom:48}},"You have ",r.a.createElement("strong",{style:{color:0===s?"red":"green"}},c?"...":s)," points.")};function xe(){var e=Object(U.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n"]);return xe=function(){return e},e}var we=function(){var e=Object(a.useState)([]),t=Object(N.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)(!0),o=Object(N.a)(c,2),i=o[0],u=o[1],s=function(e){var t=e.map((function(e){return{key:e.unix,unix:e.unix,day:re.a.unix(e.unix).format("LL dddd"),slots:e.slots}}));l(t)},f=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C.getSchedule().then((function(e){return s((null===e||void 0===e?void 0:e.data)||[])})).catch((function(e){return w(e)})).finally((function(){return u(!1)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){f()}),[]),i?r.a.createElement(Oe,null):r.a.createElement(Ce,null,!S.isAdmin()&&r.a.createElement(je,{schedule:n}),r.a.createElement(ye,{schedule:n,fetchSchedule:f}))},Ce=T.a.div(xe()),Se=function(e){var t=e.id,n=e.onComplete,a=e.loading,l={wrapperCol:{offset:8,span:12}};return r.a.createElement(B.a,Object.assign({},{labelCol:{span:8},wrapperCol:{span:12}},{name:"password",onFinish:function(e){var a=e.password;return n(a,t)}}),r.a.createElement(B.a.Item,{label:"New",name:"password",rules:[{required:!0,message:"Minimum 8 characters.",min:8}]},r.a.createElement(P.a.Password,null)),r.a.createElement(B.a.Item,{name:"confirm",label:"Confirm",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm the password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject("The two passwords that you entered do not match!"):Promise.resolve()}}}]},r.a.createElement(P.a.Password,null)),r.a.createElement(B.a.Item,l,r.a.createElement(F.a,{type:"primary",htmlType:"submit",loading:a},"Change password")))},Ie=function(){var e=Object(i.g)(),t=Object(a.useState)(!1),n=Object(N.a)(t,2),l=n[0],c=n[1];return r.a.createElement(Se,{loading:l,onComplete:function(t){C.changePassword(t,S.getId()).then((function(){return e.push("/schedule")})).catch((function(){return c(!1)}))}})},Ue=n(467),Ne=n(465),Be=n(227),Pe=n(455),Fe=n(110),Te=function(e){var t=e.id,n=e.name,l=e.surname,c=e.email,o=e.points,i=e.admin,u=e.disabled,s=e.loading,m=e.onComplete,d=Object(a.useState)(i),f=Object(N.a)(d,2),p=f[0],b=f[1],h=Object(a.useState)(u),E=Object(N.a)(h,2),v=E[0],y=E[1],k=o,O={wrapperCol:{offset:8,span:12}};return r.a.createElement(B.a,Object.assign({},{labelCol:{span:8},wrapperCol:{span:16}},{name:"user",initialValues:{remember:!1,name:n,surname:l,email:c,points:o},onFinish:function(e){m(Object(g.a)({},e,{admin:p,disabled:v,verifyPoints:k}),t)}}),r.a.createElement(B.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input the name."}]},r.a.createElement(P.a,null)),r.a.createElement(B.a.Item,{label:"Surname",name:"surname",rules:[{required:!0,message:"Please input the surname."}]},r.a.createElement(P.a,null)),r.a.createElement(B.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please type a valid email.",type:"email"}]},r.a.createElement(P.a,null)),r.a.createElement(B.a.Item,{label:"Points",name:"points",rules:[{required:!0}]},r.a.createElement(Pe.a,{min:0})),r.a.createElement(B.a.Item,{label:"Admin"},r.a.createElement(Fe.a,{onChange:function(){return b(!p)},defaultChecked:p})),r.a.createElement(B.a.Item,{label:"Disabled"},r.a.createElement(Fe.a,{onChange:function(){return y(!v)},defaultChecked:v})),r.a.createElement(B.a.Item,O,r.a.createElement(F.a,{type:"primary",loading:s,htmlType:"submit"},"Save")))};function Ae(){var e=Object(U.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  margin-top: 24px;\n\n  .ant-btn {\n    margin-right: 8px;  \n  }\n"]);return Ae=function(){return e},e}var De=function(e){var t=Object(i.g)(),n=e.fetchUsers,l=Object(a.useState)(!1),c=Object(N.a)(l,2),o=c[0],u=c[1],s=function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.then((function(){return n()})).catch((function(){return t.push("/users")})).finally((function(){return u(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(Le,null,r.a.createElement(Te,Object.assign({},e,{onComplete:function(e,t){return s(C.updateUser(e,t))},loading:o})),r.a.createElement(Se,{id:e.id,onComplete:function(e,t){return s(C.changePassword(e,t))},loading:o}))},Le=T.a.div(Ae()),Me=function(e){var t=e.data,n=e.loading,a=e.fetchUsers,l={disabled:!1,placement:"left",title:r.a.createElement("p",null,"Delete user?",r.a.createElement("br",null),r.a.createElement("br",null),"Delete user and all boookings."),okText:"OK",cancelText:"Cancel"},c=function(e){var t=e.userId;return r.a.createElement(oe.a,Object.assign({},l,{onConfirm:function(){return C.deleteUser(t)}}),r.a.createElement(Ue.a,null))},o={expandedRowRender:function(e){return r.a.createElement(De,Object.assign({},e,{fetchUsers:a}))}},i=[{title:"Name",dataIndex:"name",key:"name",ellipsis:!0,width:"20%",hideOnSmall:!0},{title:"Surname",dataIndex:"surname",key:"surname",ellipsis:!0,width:"20%"},{title:"Email",dataIndex:"email",key:"email",ellipsis:!0,width:"20%"},{title:r.a.createElement(se.a,null),key:"disabled",render:function(e){return e?r.a.createElement(Ne.a,null):""},dataIndex:"disabled",width:"10%"},{title:r.a.createElement(Z.a,null),key:"admin",render:function(e){return e?r.a.createElement(Ne.a,null):""},dataIndex:"admin",width:"10%"},{title:"",key:"id",dataIndex:"id",render:function(e){return S.getId()===e?null:r.a.createElement(c,{userId:e})},width:"5%"}],u=function(e){return i.filter((function(t){var n=t.hideOnSmall;return!(e&&(void 0!==n&&n))}))},s={expandable:o,dataSource:t,loading:n,size:"small"};return r.a.createElement(Be.a,{query:"(max-width: 599px)"},(function(e){return r.a.createElement(ve.a,Object.assign({},s,{columns:u(e)}))}))},qe=function(){var e=Object(a.useState)(!0),t=Object(N.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)([]),o=Object(N.a)(c,2),i=o[0],u=o[1],s=function(){return C.getUsers().then((function(e){return function(e){var t=e.map((function(e){return{key:e._id,id:e._id,name:e.name,surname:e.surname,email:e.email,points:e.points,admin:e.admin,disabled:e.disabled}}));u(t)}((null===e||void 0===e?void 0:e.data)||[])})).finally((function(){return l(!1)}))};return Object(a.useEffect)((function(){s()}),[]),r.a.createElement(Me,{data:i,loading:n,fetchUsers:s})},ze=function(){for(var e="bcdfghjklmnpqrstvwxyz".split(""),t="aeiou".split(""),n="",a=0;a<3;a++)n+=e[Math.floor(Math.random()*e.length)],n+=t[Math.floor(Math.random()*t.length)];return n+=Math.random().toString().substr(2,2)},He=function(){var e=Object(i.g)(),t=Object(a.useState)(!1),n=Object(N.a)(t,2),l=n[0],c=n[1],o=Object(a.useState)(null),u=Object(N.a)(o,2),s=u[0],m=u[1];return s?r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement("h3",{style:{marginBottom:24}},"User created"),r.a.createElement("p",null,"Name: ",s.name),r.a.createElement("p",null,"Surname: ",s.surname),r.a.createElement("p",null,"Email: ",r.a.createElement("strong",null,s.email)),r.a.createElement("p",null,"Password: ",r.a.createElement("strong",null,s.password)),r.a.createElement(le,{onClick:function(){return e.push("/users")}},"OK")):r.a.createElement(Te,{onComplete:function(e){c(!0);var t=Object(g.a)({},e,{password:ze()});C.createUser(t).then((function(){return m(t)})).catch((function(){return m(null)})).finally((function(){return c(!1)}))},loading:l})},Re=n(170);function Ve(){var e=Object(U.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n"]);return Ve=function(){return e},e}var _e=pe.a.Option,We={labelCol:{span:8},wrapperCol:{span:12}},Ke={wrapperCol:{offset:8,span:12}},Je=function(e){var t,n=e.slots,l=e.loading,c=e.onSubmit,o=Object(a.useState)(),i=Object(N.a)(o,2),u=i[0],s=i[1],f=Object(a.useState)(0),p=Object(N.a)(f,2),b=p[0],h=p[1],g=Object(a.useState)((null===(t=n[0][0])||void 0===t?void 0:t.unix)||0),E=Object(N.a)(g,2),v=E[0],y=E[1],k=Object(a.useState)(re()()),O=Object(N.a)(k,2),j=O[0],x=O[1],w=Object(a.useState)(re()().add(1,"months")),C=Object(N.a)(w,2),S=C[0],I=C[1],U=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(u,b,v,j.unix(),S.unix());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Ye,null,r.a.createElement(B.a,Object.assign({},We,{name:"basic",onFinish:U}),r.a.createElement(B.a.Item,{label:"User",name:"user"},r.a.createElement(be,{setUser:s})),r.a.createElement(B.a.Item,{label:"Day"},r.a.createElement(pe.a,{defaultValue:0,onChange:function(e){return h(e)}},["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((function(e,t){return r.a.createElement(_e,{key:Math.random(),value:t},e)})))),r.a.createElement(B.a.Item,{label:"Slot"},r.a.createElement(pe.a,{key:n[b][0].unix,defaultValue:n[b][0].value,onChange:function(e){return y(e)}},n[b].map((function(e){var t=e.unix,n=e.value;return r.a.createElement(_e,{key:t,value:t},n)})))),r.a.createElement(B.a.Item,{label:"From"},r.a.createElement(Re.a,{value:j,onChange:function(e){return x(e)},allowClear:!1})),r.a.createElement(B.a.Item,{label:"To"},r.a.createElement(Re.a,{value:S,onChange:function(e){return I(e)},allowClear:!1})),r.a.createElement(B.a.Item,Ke,r.a.createElement(F.a,{type:"primary",htmlType:"submit",loading:l},"Create"))))},Ye=T.a.div(Ve()),$e=function(){var e=Object(i.g)(),t=Object(a.useState)(!0),n=Object(N.a)(t,2),l=n[0],c=n[1],o=Object(a.useState)(),u=Object(N.a)(o,2),s=u[0],f=u[1];Object(a.useEffect)((function(){C.getDaySlots().then((function(e){f(e.data),c(!1)})).catch((function(){return e.push("/")}))}),[]);var p=function(){var e=Object(d.a)(m.a.mark((function e(t,n,a,r,l){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.bookBatch({userId:t,day:n,slot:a,from:r,to:l});case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,r,l){return e.apply(this,arguments)}}();return l?r.a.createElement(Oe,null):r.a.createElement(Je,{onSubmit:p,slots:s})},Ge=n(236),Qe=n(235),Xe=n(449),Ze=function(e){var t=e.onComplete,n=e.loading,l=e.settings,c={wrapperCol:{offset:14,span:12}},o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=Object(a.useState)(0),u=Object(N.a)(i,2),s=u[0],m=u[1],d=Object(a.useState)(l.week.map((function(e){return{startHours:e.startHours,startMinutes:e.startMinutes,slotNumber:e.slotNumber,off:e.off}}))),f=Object(N.a)(d,2),p=f[0],b=f[1],h=function(e,t,n){var a=Object(Ge.a)(Array,Object(Qe.a)(p));switch(t){case"time":a[n].startHours=e.hours(),a[n].startMinutes=e.minutes();break;case"slots":a[n].slotNumber=e;break;case"off":a[n].off=e.target.checked}b(a)},E=function(){var e,t,n=(e=p[s].startHours,t=p[s].startMinutes,re()(e+":"+t,"HH:mm"));return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{placement:"right",title:"Starting time for "+o[s]},r.a.createElement(Xe.a,{defaultValue:n,format:"HH:mm",allowClear:!1,style:{marginBottom:8},onChange:function(e){return h(e,"time",s)}})),r.a.createElement("br",null),r.a.createElement(H.a,{placement:"right",title:"Number of slots for "+o[s]},r.a.createElement(Pe.a,{placeholder:"slots",defaultValue:p[s].slotNumber,style:{marginBottom:8},min:1,onChange:function(e){return h(e,"slots",s)}})),r.a.createElement("br",null),r.a.createElement(Fe.a,{defaultChecked:p[s].off,onChange:function(e){return h(e,"off",s)}},"Day off"))};return r.a.createElement(B.a,Object.assign({},{labelCol:{span:14},wrapperCol:{span:12}},{name:"settings",initialValues:Object(g.a)({remember:!1},l,{lastBookableDay:re.a.unix(l.lastBookableDay),day:0}),onFinish:function(e){var n=e.cancelationNotice,a=e.interval,r=e.expireOffset,l=e.slotDuration,c=e.dailyLimit,o={cancelationNotice:n,interval:a,expireOffset:r,slotDuration:l,lastBookableDay:e.lastBookableDay.unix(),dailyLimit:c,week:p};t(o)}}),r.a.createElement(B.a.Item,{name:"lastBookableDay",label:"Last available day"},r.a.createElement(Re.a,{allowClear:!1})),r.a.createElement(B.a.Item,{name:"slotDuration",label:"Slot duration (mins)"},r.a.createElement(Pe.a,{min:5,max:1440,step:5,disabled:!0})),r.a.createElement(B.a.Item,{name:"interval",label:"Interval (mins)"},r.a.createElement(Pe.a,{min:0,max:1440,step:5,disabled:!0})),r.a.createElement(B.a.Item,{name:"expireOffset",label:"Slot expiration (mins)"},r.a.createElement(Pe.a,{min:0,max:1440,step:5})),r.a.createElement(B.a.Item,{name:"cancelationNotice",label:"Slot cancellation (hours)"},r.a.createElement(Pe.a,{min:0,max:365,step:1})),r.a.createElement(B.a.Item,{name:"dailyLimit",label:"Bookings limit per day"},r.a.createElement(Pe.a,{min:0,step:1})),r.a.createElement(B.a.Item,{name:"day",label:"Day settings"},r.a.createElement(pe.a,{onSelect:function(e){return m(e)},options:o.map((function(e,t){return{label:e,value:t}}))})),r.a.createElement(B.a.Item,{label:"Day options"},r.a.createElement(E,{dayIndex:s})),r.a.createElement(B.a.Item,c,r.a.createElement(F.a,{type:"primary",loading:n,htmlType:"submit"},"Save")))};function et(){var e=Object(U.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return et=function(){return e},e}var tt=function(){var e=Object(i.g)(),t=Object(a.useState)(!0),n=Object(N.a)(t,2),l=n[0],c=n[1],o=Object(a.useState)(),u=Object(N.a)(o,2),s=u[0],m=u[1];return Object(a.useEffect)((function(){c(!0),C.getSettings().then((function(e){m(e.data),c(!1)})).catch((function(){return e.push("/")}))}),[]),l?r.a.createElement(Oe,null):r.a.createElement(nt,null,r.a.createElement(Ze,{settings:s,loading:l,onComplete:function(e){c(!0),C.saveSettings(e).then((function(e){return m(e.data)})).finally((function(){return c(!1)}))}}))},nt=T.a.div(et()),at=function(){return r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:["/","/schedule"],component:function(){return r.a.createElement(we,null)}}),r.a.createElement(i.b,{exact:!0,path:"/change-password",component:function(){return r.a.createElement(Ie,null)}}),r.a.createElement(i.b,{exact:!0,path:"/users",component:function(){return r.a.createElement(qe,null)}}),r.a.createElement(i.b,{exact:!0,path:"/create-user",component:function(){return r.a.createElement(He,null)}}),r.a.createElement(i.b,{exact:!0,path:"/create-bookings",component:function(){return r.a.createElement($e,null)}}),r.a.createElement(i.b,{exact:!0,path:"/settings",component:function(){return r.a.createElement(tt,null)}}))};function rt(){var e=Object(U.a)(["\n\n  .layout {\n    min-height: 100vh;\n  }\n\n  .content {\n    display: flex;\n    justify-content: center;\n    padding: 4em 25vw 0 25vw;\n  }\n\n  .footer {\n    font-size: 11px;\n  }\n\n  @media only screen and (max-width: 800px) {\n\n    .content {\n      padding: 2em 16px 0 16px;\n    }\n  }\n\n"]);return rt=function(){return e},e}var lt=z.a.Footer,ct=function(){return r.a.createElement(ot,null,r.a.createElement(z.a,{className:"layout",theme:"light"},r.a.createElement(W,null),r.a.createElement(te,null),r.a.createElement("div",{className:"content"},r.a.createElement(at,null)),r.a.createElement(lt,{className:"footer",style:{textAlign:"center"}})))},ot=T.a.div(rt()),it=function(){return r.a.createElement(o.a,{basename:"/booking-manager-frontend"},r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/login"},r.a.createElement(M,null)),r.a.createElement(I,{path:"/",component:function(){return r.a.createElement(ct,null)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ut=n(452);n(441);ut.a({dsn:"https://9e88b37548ca41e1808ff6bedf7219f3@o381096.ingest.sentry.io/5207910"}),c.a.render(r.a.createElement(it,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[239,1,2]]]);
//# sourceMappingURL=main.313db2ef.chunk.js.map